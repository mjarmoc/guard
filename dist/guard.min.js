/*
 *  jquery-guard - v1.0.0
 *  Jquery plugin that guards your forms.
 *  https://github.com/mjarmoc/guard
 *
 *  Author: Michal Jarmoc || https://github.com/mjarmoc 
 *  Licensed under MIT License
 */
var guard={fields:[],invalid:[],options:{sections:!1,live:!0,parentClass:"form-group"},errors:{required:"Please enter a value",requiredSelect:"Please select an option",requiredCheckbox:"Please check the input",requiredRadio:"Please select an option",email:"Please enter a valid email format - login@host.domain",number:"Please enter a numerical value",minLength:"The field has to contain at least {x} signs",maxLength:"The field has to contain at most {x} signs"},rules:{required:function(a){if(a.is("input"))switch(a.attr("type")){default:return a.val().length>0||guard.errors.required;case"checkbox":return a.prop("checked")||guard.errors.requiredCheckbox;case"radio":var b=$('[name="'+a.attr("name")+'"]:checked').length;return b>0||guard.errors.requiredRadio}else{if(a.is("select"))return 0!==a[0].selectedIndex||guard.errors.requiredSelect;if(a.is("textarea"))return a.val().length>0||guard.errors.required}},email:function(a){var b=new RegExp(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);return b.test(a.val())||guard.errors.email},number:function(a){var b=new RegExp(/^[\-\+]?(\d+|\d+\.?\d+)$/);return b.test(a.val())||guard.errors.number},maxLength:function(a,b,c){return b>=c||guard.errors.maxLength.replace("{x}",b)},minLength:function(a,b,c){return c>=b||guard.errors.minLength.replace("{x}",b)}},validate:function(a){var b,c,a=$(a),d=a.data("guard").split(",");$.each(d,function(d,e){if(-1!==e.indexOf("{")&&(b=e.slice(e.indexOf("{")+1,e.indexOf("}")),e=e.slice(0,e.indexOf("{"))),"text"==a.attr("type")||a.is("textarea")){var f=a.val().length;c=0!==f||"required"===e?guard.rules[e](a,b,f):!0}else c=guard.rules[e](a,b);return c!==!0?(guard._createError(a,c),!1):(guard._cleanError(a),c)})},_collect:function(a,b){this.fields=this.options.sections&&void 0!==b?a.find(this.options.sections).eq(b).find("[data-guard]"):a.find("[data-guard]")},_cleanError:function(a){var b=a.parents("."+this.options.parentClass),c=b.find(".guard-error");b.hasClass("guard-invalid")&&b.removeClass("guard-invalid"),c.length&&c.remove()},_createError:function(a,b){var c=a.parents("."+this.options.parentClass);c.hasClass("guard-invalid")||c.addClass("guard-invalid").append('<div class="guard-error">'+b+"</div>"),guard.invalid.push(a)},check:function(a){return guard.invalid=[],this._collect(this.$form,a),$.each(this.fields,function(a,b){guard.validate(b)}),0==guard.invalid.length?!0:!1},init:function(a,b,c,d){return this.options=$.extend({},this.options,a),this.errors=$.extend({},this.errors,b),this.rules=$.extend({},this.rules,c),this.form=d,this.$form=$(d),this.options.live&&$("[data-guard]").bind("change",function(){guard.validate(this)}),this.$form.submit(function(a){a.preventDefault(),guard.check()&&("function"==typeof guard.options.onSubmit?guard.options.onSubmit.call(this,a):this.submit())}),this}};"function"!=typeof Object.create&&(Object.create=function(a){function b(){}return b.prototype=a,new b}),function(a){a.fn.guard=function(b,c,d){return this.length?this.each(function(){Object.create(guard);guard.init(b,c,d,this),a.data(this,"guard",guard)}):void 0}}(jQuery);