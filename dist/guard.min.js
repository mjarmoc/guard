/*
 *  jquery-guard - v1.2.0
 *  Jquery plugin that guards your forms.
 *  https://github.com/mjarmoc/guard
 *
 *  Author: Michal Jarmoc || https://github.com/mjarmoc 
 *  Licensed under MIT License
 */
var Guard=function(a,b,c,d){var e=this;this.form=d,this.$form=$(d),this.fields=[],this.invalid=[],this.options={sections:!1,live:!0,parentClass:"form-group"},this.errors={required:"Please enter a value",requiredSelect:"Please select an option",requiredCheckbox:"Please check the input",requiredRadio:"Please select an option",email:"Please enter a valid email format - login@host.domain",number:"Please enter a numerical value",minLength:"The field has to contain at least {x} signs",maxLength:"The field has to contain at most {x} signs",isLength:"The field has to contain {x} signs",minValue:"The field value has to be greater than {x}",maxValue:"The field value has to be less than {x}"},this.rules={required:function(a){if(a.is("input"))switch(a.attr("type")){default:return a.val().length>0||e.errors.required;case"checkbox":return a.prop("checked")||e.errors.requiredCheckbox;case"radio":var b=$('[name="'+a.attr("name")+'"]:checked').length;return b>0||e.errors.requiredRadio}else{if(a.is("select"))return 0!==a[0].selectedIndex||e.errors.requiredSelect;if(a.is("textarea"))return a.val().length>0||e.errors.required}},email:function(a){var b=new RegExp(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);return b.test(a.val())||e.errors.email},number:function(a){var b=new RegExp(/^[\-\+]?(\d+|\d+\.?\d+)$/);return b.test(a.val())||e.errors.number},maxLength:function(a,b,c){return b>=c||e.errors.maxLength.replace("{x}",b)},minLength:function(a,b,c){return c>=b||e.errors.minLength.replace("{x}",b)},isLength:function(a,b){return a.val().length==b||e.errors.isLength.replace("{x}",b)},minValue:function(a,b){return a.val()>=b||e.errors.minValue.replace("{x}",b)},maxValue:function(a,b){return a.val()<=b||e.errors.minValue.replace("{x}",b)}},this.validate=function(a){var b,c,a=$(a),d=a.data("guard").split(",");$.each(d,function(d,f){if(-1!==f.indexOf("{")&&(b=f.slice(f.indexOf("{")+1,f.indexOf("}")),f=f.slice(0,f.indexOf("{"))),"text"==a.attr("type")||a.is("textarea")){var g=a.val().length;c=0!==g||"required"===f?e.rules[f](a,b,g):!0}else c=e.rules[f](a,b);return c!==!0?(e._createError(a,c),!1):(e._cleanError(a),c)})},this._collect=function(a){this.fields=this.options.sections&&void 0!==a?this.$form.find(this.options.sections).eq(a).find("[data-guard]"):this.$form.find("[data-guard]")},this._cleanError=function(a){var b=a.parents("."+this.options.parentClass),c=b.find(".guard-error");b.hasClass("guard-invalid")&&b.removeClass("guard-invalid"),c.length&&c.remove()},this._createError=function(a,b){var c=a.parents("."+this.options.parentClass);c.hasClass("guard-invalid")||c.addClass("guard-invalid").append('<div class="guard-error">'+b+"</div>"),e.invalid.push(a)},this.check=function(a,b){return e.invalid=[],this._collect(a,b),$.each(this.fields,function(a,b){e.validate(b)}),0==e.invalid.length?!0:!1},this.init=function(){e.options=$.extend({},this.options,a),e.errors=$.extend({},this.errors,b),e.rules=$.extend({},this.rules,c),1==e.options.live&&e.$form.find("[data-guard]").bind("change",function(){e.validate(this)}),e.$form.submit(function(a){a.preventDefault(),e.check()&&("function"==typeof e.options.beforeSubmit&&e.options.beforeSubmit.call(this,a),"function"==typeof e.options.onSubmit?e.options.onSubmit.call(this,a):this.submit())})},this.init()};!function(a){a.fn.guard=function(b,c,d){return this.length?this.each(function(){var e=new Guard(b,c,d,this);a.data(this,"guardApi",e)}):void 0}}(jQuery);